const j={async sendMessage(n,s,o){var a,i,c,p,d,h,l,g,m,w,y,u,f;if(n.startsWith("gemini")){if(!o.geminiKey)throw new Error("Google Gemini API Key is missing. Please add it in Account settings.");const t=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${n==="gemini-3-flash"?"gemini-3-flash-preview":"gemini-3-pro-preview"}:generateContent?key=${o.geminiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:s.map(e=>({role:e.role==="assistant"?"model":"user",parts:[{text:e.content}]}))})});if(!t.ok){const e=await t.json();throw new Error(((a=e.error)==null?void 0:a.message)||"Failed to fetch from Gemini")}return((h=(d=(p=(c=(i=(await t.json()).candidates)==null?void 0:i[0])==null?void 0:c.content)==null?void 0:p.parts)==null?void 0:d[0])==null?void 0:h.text)||"No response."}if(n.startsWith("gpt")){if(!o.openaiKey)throw new Error("OpenAI API Key is missing. Please add it in Account settings.");const t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.openaiKey}`},body:JSON.stringify({model:"gpt-5.2",messages:s.map(e=>({role:e.role,content:e.content})),temperature:.7})});if(!t.ok){const e=await t.json();throw new Error(((l=e.error)==null?void 0:l.message)||"Failed to fetch from OpenAI")}return((w=(m=(g=(await t.json()).choices)==null?void 0:g[0])==null?void 0:m.message)==null?void 0:w.content)||"No response."}if(n.startsWith("claude")){if(!o.anthropicKey)throw new Error("Anthropic API Key is missing. Please add it in Account settings.");const r=n==="claude-4.5-opus"?"claude-opus-4-5":"claude-4.5-sonnet",t=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":o.anthropicKey,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:r,max_tokens:1024,messages:s.map(e=>({role:e.role,content:e.content}))})});if(!t.ok){const e=await t.json();throw new Error(((y=e.error)==null?void 0:y.message)||"Failed to fetch from Anthropic")}return((f=(u=(await t.json()).content)==null?void 0:u[0])==null?void 0:f.text)||"No response."}throw new Error("Unknown model selected")}};export{j as aiService};
